 WITH DADOS AS (
 SELECT   
 CASE WHEN strftime('%m', DATATRANSACAO) in ('12') AND strftime('%Y', DATATRANSACAO) in ('2022')  THEN  CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [JAN]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [FEV]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01','02') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [MAR]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01','02','03') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [ABR]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01','02','03','04') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [MAI]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01','02','03','04','05') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [JUN]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01','02','03','04','05','06') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [JUL]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01','02','03','04','05','06','07') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [AGO]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01','02','03','04','05','06','07','08') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [SET]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01','02','03','04','05','06','07','08','09') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [OUT]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01','02','03','04','05','06','07','08','09','10') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [NOV]
,CASE WHEN strftime('%m', DATATRANSACAO) IN ('12','01','02','03','04','05','06','07','08','09,''10','11') AND strftime('%Y', DATATRANSACAO) == '2023' THEN CAST(IFNULL(SUM(VALOR),0.00) AS NUMERIC(15,02)) END AS [DEZ]


	FROM TBTRANSACAO T   
  LEFT OUTER JOIN CENTRODECUSTO CC ON CC.CENTRODECUSTO = T.CENTRODECUSTO and CC.ID_USER = 3 and CC.ID_LANGUAGE = 1 
 	WHERE  1 = 1  
    AND T.FORECAST = 0 
 	AND T.DATATRANSACAO >= '2023-01-01' 
 	AND T.DATATRANSACAO <= '2024-01-31' 
 	GROUP BY strftime('%m', DATATRANSACAO)
)
SELECT SUM([Jan]) as JAN, SUM([Fev]) as Fev, SUM([MAR]) as Mar, SUM([ABR]) as ABR, SUM([MAI]) as MAI, SUM([JUN]) as JUN
, SUM([JUL]) as JUL, SUM([AGO]) as AGO, SUM([SET]) as [SET],  SUM([OUT]) as [OUT], SUM([NOV]) as NOV, SUM([DEZ]) as DEZ
from Dados
